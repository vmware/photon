diff --git a/src/mon/CMakeLists.txt b/src/mon/CMakeLists.txt
index 0404454..18d5ee1 100644
--- a/src/mon/CMakeLists.txt
+++ b/src/mon/CMakeLists.txt
@@ -5,6 +5,7 @@ set(lib_mon_srcs
   ${osd_mon_files}
   Paxos.cc
   PaxosService.cc
+  ../osd/OSDCap.cc
   OSDMonitor.cc
   MDSMonitor.cc
   FSCommands.cc
diff --git a/src/mon/OSDMonitor.cc b/src/mon/OSDMonitor.cc
index 80a3ff0..8423dd5 100644
--- a/src/mon/OSDMonitor.cc
+++ b/src/mon/OSDMonitor.cc
@@ -136,7 +136,7 @@ bool is_unmanaged_snap_op_permitted(CephContext* cct,
 
   string caps_str;
   if (caps_info.caps.length() > 0) {
-    auto p = caps_info.caps.cbegin();
+    auto p = caps_info.caps.begin();
     try {
       decode(caps_str, p);
     } catch (const buffer::error &err) {
