From 9690d3ab1f9bcd2db8cbe1fe3ee4a5da606b8814 Mon Sep 17 00:00:00 2001
From: "K.Kosako" <kosako@sofnec.co.jp>
Date: Tue, 23 May 2017 16:15:35 +0900
Subject: [PATCH] fix #58 : access to invalid address by reg->dmin value

---
 regexec.c | 2 ++
 1 file changed, 2 insertions(+)

diff --git a/regexec.c b/regexec.c.1
index 9e5f559..0c6d7df 100644
--- a/regexec.c
+++ b/regexec.c.1
@@ -3917,6 +3917,8 @@ forward_search_range(regex_t* reg, const UChar* str, const UChar* end, UChar* s,
     }
     else {
       UChar *q = p + reg->dmin;
+
+      if (q >= end) return 0; /* fail */
       while (p < q) p += enclen(reg->enc, p, end);
     }
   }

