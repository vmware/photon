From ef135d4314fd4c2d7da66b9d7b59af4a85b0f7e6 Mon Sep 17 00:00:00 2001
From: Nick Clifton <nickc@redhat.com>
Date: Thu, 8 Feb 2018 10:28:25 +0000
Subject: [PATCH 1/1] Fix a seg-fault in the ELF note parser when a note with
 an excessively large alignment is encountered.

	PR 22788
	* elf.c (elf_parse_notes): Reject notes with excessuively large
	alignments.
---
 bfd/ChangeLog | 6 ++++++
 bfd/elf.c     | 2 ++
 2 files changed, 8 insertions(+)

diff --git a/bfd/elf.c b/bfd/elf.c
index dedf35f..db1e076 100644
--- a/bfd/elf.c
+++ b/bfd/elf.c
@@ -11012,6 +11012,8 @@ elf_parse_notes (bfd *abfd, char *buf, size_t size, file_ptr offset,
      align is less than 4, we use 4 byte alignment.   */
   if (align < 4)
     align = 4;
+  if (align != 4 && align != 8)
+    return FALSE;
 
   p = buf;
   while (p < buf + size)
-- 
2.9.3
