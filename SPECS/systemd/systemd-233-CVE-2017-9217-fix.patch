diff --git a/src/resolve/resolved-dns-packet.c b/src/resolve/resolved-dns-packet.c
index 6529702..7ff6d1f 100644
--- a/src/resolve/resolved-dns-packet.c
+++ b/src/resolve/resolved-dns-packet.c
@@ -2253,38 +2253,41 @@ int dns_packet_extract(DnsPacket *p) {
 
 int dns_packet_is_reply_for(DnsPacket *p, const DnsResourceKey *key) {
         int r;
 
         assert(p);
         assert(key);
 
         /* Checks if the specified packet is a reply for the specified
          * key and the specified key is the only one in the question
          * section. */
 
         if (DNS_PACKET_QR(p) != 1)
                 return 0;
 
         /* Let's unpack the packet, if that hasn't happened yet. */
         r = dns_packet_extract(p);
         if (r < 0)
                 return r;
 
+        if (p->question == NULL)
+                return 0;
+
         if (p->question->n_keys != 1)
                 return 0;
 
         return dns_resource_key_equal(p->question->keys[0], key);
 }
 
 static const char* const dns_rcode_table[_DNS_RCODE_MAX_DEFINED] = {
         [DNS_RCODE_SUCCESS] = "SUCCESS",
         [DNS_RCODE_FORMERR] = "FORMERR",
         [DNS_RCODE_SERVFAIL] = "SERVFAIL",
         [DNS_RCODE_NXDOMAIN] = "NXDOMAIN",
         [DNS_RCODE_NOTIMP] = "NOTIMP",
         [DNS_RCODE_REFUSED] = "REFUSED",
         [DNS_RCODE_YXDOMAIN] = "YXDOMAIN",
         [DNS_RCODE_YXRRSET] = "YRRSET",
         [DNS_RCODE_NXRRSET] = "NXRRSET",
         [DNS_RCODE_NOTAUTH] = "NOTAUTH",
         [DNS_RCODE_NOTZONE] = "NOTZONE",
         [DNS_RCODE_BADVERS] = "BADVERS",
