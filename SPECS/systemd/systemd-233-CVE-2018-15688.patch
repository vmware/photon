--- a/src/libsystemd-network/dhcp6-option.c	2018-11-02 19:08:04.002213321 +0530
+++ b/src/libsystemd-network/dhcp6-option.c	2018-11-02 19:08:51.198213161 +0530
@@ -101,7 +101,7 @@ int dhcp6_option_append_ia(uint8_t **buf
                 return -EINVAL;
         }
 
-        if (*buflen < len)
+        if (*buflen < offsetof(DHCP6Option, data) + len)
                 return -ENOBUFS;
 
         ia_hdr = *buf;
