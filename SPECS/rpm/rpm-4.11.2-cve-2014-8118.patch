--- a/lib/cpio.c	2016-10-18 22:18:29.512000000 +0000
+++ b/lib/cpio.c	2016-10-18 22:37:07.136000000 +0000
@@ -296,6 +296,9 @@
     st->st_rdev = makedev(major, minor);
 
     GET_NUM_FIELD(hdr.namesize, nameSize);
+    if (nameSize <= 0 || nameSize > 4096) {
+        return CPIOERR_BAD_HEADER;
+    }
 
     *path = xmalloc(nameSize + 1);
     read = Fread(*path, nameSize, 1, cpio->fd);
